---
title: "HW4"
output: word_document
---
```{r}
library(randomForest)
```

```{r}
filelist_1 = list.files('HMP_Dataset/Brush_teeth/',pattern = '*.txt')
filelist_2 = list.files('HMP_Dataset/Climb_stairs/',pattern = '*.txt')
filelist_3 = list.files('HMP_Dataset/Comb_hair/',pattern = '*.txt')
filelist_4 = list.files('HMP_Dataset/Descend_stairs/',pattern = '*.txt')
filelist_5 = list.files('HMP_Dataset/Drink_glass/',pattern = '*.txt')
filelist_6 = list.files('HMP_Dataset/Eat_meat/',pattern = '*.txt')
filelist_7 = list.files('HMP_Dataset/Eat_soup/',pattern = '*.txt')
filelist_8 = list.files('HMP_Dataset/Getup_bed/',pattern = '*.txt')
filelist_9 = list.files('HMP_Dataset/Liedown_bed/',pattern = '*.txt')
filelist_10 = list.files('HMP_Dataset/Pour_water/',pattern = '*.txt')
filelist_11 = list.files('HMP_Dataset/Sitdown_chair/',pattern = '*.txt')
filelist_12 = list.files('HMP_Dataset/Standup_chair/',pattern = '*.txt')
filelist_13 = list.files('HMP_Dataset/Use_telephone/',pattern = '*.txt')
filelist_14 = list.files('HMP_Dataset/Walk/',pattern = '*.txt')

brush_teeth = lapply(paste('HMP_Dataset/Brush_teeth/',filelist_1,sep = '/'), function(x) read.table(x, header=FALSE))
climb_stairs = lapply(paste('HMP_Dataset/Climb_stairs/',filelist_2,sep = '/'), function(x) read.table(x, header=FALSE))
comb_hair = lapply(paste('HMP_Dataset/Comb_hair/',filelist_3,sep = '/'), function(x) read.table(x, header=FALSE)) 
descend_stairs = lapply(paste('HMP_Dataset/Descend_stairs/',filelist_4,sep = '/'), function(x) read.table(x, header=FALSE)) 
drink_glass = lapply(paste('HMP_Dataset/Drink_glass/',filelist_5,sep = '/'), function(x) read.table(x, header=FALSE)) 
eat_meat = lapply(paste('HMP_Dataset/Eat_meat/',filelist_6,sep = '/'), function(x) read.table(x, header=FALSE)) 
eat_soup = lapply(paste('HMP_Dataset/Eat_soup/',filelist_7,sep = '/'), function(x) read.table(x, header=FALSE)) 
getup_bed = lapply(paste('HMP_Dataset/Getup_bed/',filelist_8,sep = '/'), function(x) read.table(x, header=FALSE)) 
liedown_bed = lapply(paste('HMP_Dataset/Liedown_bed/',filelist_9,sep = '/'), function(x) read.table(x, header=FALSE)) 
pour_water = lapply(paste('HMP_Dataset/Pour_water/',filelist_10,sep = '/'), function(x) read.table(x, header=FALSE)) 
sitdown_chair = lapply(paste('HMP_Dataset/Sitdown_chair/',filelist_11,sep = '/'), function(x) read.table(x, header=FALSE)) 
standup_chair = lapply(paste('HMP_Dataset/Standup_chair/',filelist_12,sep = '/'), function(x) read.table(x, header=FALSE)) 
use_telephone = lapply(paste('HMP_Dataset/Use_telephone/',filelist_13,sep = '/'), function(x) read.table(x, header=FALSE)) 
walk = lapply(paste('HMP_Dataset/Walk/',filelist_14,sep = '/'), function(x) read.table(x, header=FALSE)) 
remove(filelist_1,filelist_2,filelist_3,filelist_4,filelist_5,filelist_6,filelist_7,filelist_8,filelist_9,filelist_10,filelist_11,filelist_12,filelist_13,filelist_14)
```

```{r}
for(i in 1:length(brush_teeth)){
  brush_teeth[[i]]$label = 1
}

for(i in 1:length(climb_stairs)){
    climb_stairs[[i]]$label = 2
}

for(i in 1:length(comb_hair)){
    comb_hair[[i]]$label = 3
}

for(i in 1:length(descend_stairs)){
    descend_stairs[[i]]$label = 4
}

for(i in 1:length(drink_glass)){
    drink_glass[[i]]$label = 5
}

for(i in 1:length(eat_meat)){
    eat_meat[[i]]$label = 6
}

for(i in 1:length(eat_soup)){
    eat_soup[[i]]$label = 7
}

for(i in 1:length(getup_bed)){
    getup_bed[[i]]$label = 8
}

for(i in 1:length(liedown_bed)){
    liedown_bed[[i]]$label = 9
}

for(i in 1:length(pour_water)){
    pour_water[[i]]$label = 10
}

for(i in 1:length(sitdown_chair)){
    sitdown_chair[[i]]$label = 11
}

for(i in 1:length(standup_chair)){
    standup_chair[[i]]$label = 12
}

for(i in 1:length(use_telephone)){
    use_telephone[[i]]$label = 13
}

for(i in 1:length(walk)){
    walk[[i]]$label = 14
}
print(brush_teeth[[1]])
print(walk[[1]])
```

```{r}
head(nrow(brush_teeth[[1]]))
```


```{r}
#allData <- list()

class_list <- list(c(brush_teeth,climb_stairs,comb_hair,descend_stairs,drink_glass,eat_meat,eat_soup,getup_bed,liedown_bed,pour_water,sitdown_chair,standup_chair,use_telephone,walk))

trainSize <- floor(0.8*length(class_list[[1]]))
set.seed(123)
trainData <- sample(as.vector(class_list[[1]]), size = trainSize)
testData <- setdiff(class_list[[1]], trainData)

cutSize <- 50
cutData <- function(trainData){
  cuttedData <- numeric()
  for(i in 1:length(trainData))
  {
    start <- 1
    end <- cutSize
    chunkSize <- floor( nrow(trainData[[i]]) / cutSize )
    #print(chunkSize)
    dataPoint <- trainData[[i]]
    
    for(j in 1:chunkSize)
    {
      xyzData <- t(dataPoint[start:end,])
      temp <- xyzData[1,]
      temp <- c(temp, xyzData[2,])
      temp <- c(temp, xyzData[3,])
      cuttedData <- c(cuttedData, temp)
  
      cuttedData <- c(cuttedData, xyzData[4,1])
      start <- start + cutSize
      end <- end + cutSize
    }
  }
  cuttedData <- matrix(cuttedData, ncol = 151, byrow = TRUE)
  return (cuttedData)
}
cuttedTrainDataWithLabels <- cutData(trainData)
print(cuttedTrainDataWithLabels)
cuttedTestDataWithLabels <- cutData(testData)

trainDataLabels <- cuttedTrainDataWithLabels[, 151]
testDataLabels <- cuttedTestDataWithLabels[, 151]

cuttedTrainData <- cuttedTrainDataWithLabels[, 1:150]
cuttedTestData <- cuttedTestDataWithLabels[, 1:150]

```
```{r}
print(dim(cuttedTrainData))
print(dim(cuttedTestData))
print(trainDataLabels)
print(testDataLabels)
```


```{r}
kmeans_14 = kmeans(cuttedTrainData,centers = 14)
cluster_vec <- kmeans_14$cluster

print(typeof(cluster_vec))
print(length(cluster_vec))
print(cluster_vec[1])

getActivitySummary <- function(cvec, labels, activityIndex)
{
  activity_summary <- rep(0,14)
  
  for(index in 1:length(cvec))
  {
    if(labels[index] == activityIndex)
    {
      cluster_center_index <- cvec[index]
      activity_summary[cluster_center_index] <- activity_summary[cluster_center_index] + 1
    }
  }
  return (activity_summary)
}

activity1_summary <- getActivitySummary(cluster_vec, trainDataLabels, 1)
activity2_summary <- getActivitySummary(cluster_vec, trainDataLabels, 2)
activity3_summary <- getActivitySummary(cluster_vec, trainDataLabels, 3)
activity4_summary <- getActivitySummary(cluster_vec, trainDataLabels, 4)
activity5_summary <- getActivitySummary(cluster_vec, trainDataLabels, 5)
activity6_summary <- getActivitySummary(cluster_vec, trainDataLabels, 6)
activity7_summary <- getActivitySummary(cluster_vec, trainDataLabels, 7)
activity8_summary <- getActivitySummary(cluster_vec, trainDataLabels, 8)
activity9_summary <- getActivitySummary(cluster_vec, trainDataLabels, 9)
activity10_summary <- getActivitySummary(cluster_vec, trainDataLabels, 10)
activity11_summary <- getActivitySummary(cluster_vec, trainDataLabels, 11)
activity12_summary <- getActivitySummary(cluster_vec, trainDataLabels, 12)
activity13_summary <- getActivitySummary(cluster_vec, trainDataLabels, 13)
activity14_summary <- getActivitySummary(cluster_vec, trainDataLabels, 14)

print(activity1_summary)
print(activity2_summary)
print(activity3_summary)
print(activity4_summary)
print(activity5_summary)
print(activity6_summary)
print(activity7_summary)
print(activity8_summary)
print(activity9_summary)
print(activity10_summary)
print(activity11_summary)
print(activity12_summary)
print(activity13_summary)
print(activity14_summary)


#print(activity_summary_1)
#print(activity_summary_6)

#print(dim(kmeans_40$centers))
#fitted(kmeans_40,method=c("centers", "classes"))
```

```{r}
cuttedTestData <- cutData(testData)
#print(typeof(cuttedTestData[1,1]))
#print(cuttedTestData)
```

```{r}
centers_14 = kmeans_14$centers
new_centers_14 = data.frame(centers_14)
```

```{r}
center_label = list(1,2,3,4,5,6,7,8,9,10,11,12,13,14)
for(i in 1:nrow(new_centers_14)){
  #print(new_centers_14[i,])
  #print(center_label[[i]])
  new_centers_14[i,151]= center_label[[i]]
}
```


```{r}
set.seed(123)
randomForest()
```

